#! /usr/bin/env sh

dir="$(dirname $(readlink -f "${0}"))"

if [ ! -e /etc/sitegen ]
then
  rm -f /etc/sitegen &&
  cp -r "${dir}/sitegen" /etc/sitegen
fi &&

cp "${dir}/sitegen.py" /usr/local/bin/sitegen &&
cp "${dir}/bash/sitegen.completion" /etc/bash_completion.d/sitegen &&

cp "${dir}/apache/letsencrypt.conf" /etc/apache2/conf-available/letsencrypt.conf &&
a2enconf letsencrypt &&
service apache2 reload &&

if [ ! -e /etc/cron.d/sitegen-cert-renew ]
then
  cp "${dir}/cron/sitegen-cert-renew" /etc/cron.d/sitegen-cert-renew
fi &&
service cron reload
